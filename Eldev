;; -*- mode: emacs-lisp; lexical-binding: t -*-

(setf eldev-project-main-file "vulpea-ui.el")

(eldev-use-package-archive 'gnu)
(eldev-use-package-archive 'melpa-unstable)

;; Use local dependencies when available, otherwise fetch from GitHub.
;; Local paths can be set via environment variables or detected automatically.
(defun brb-eldev-use-local-or-vc (name env-var default-path github-repo)
  "Use local dependency NAME if available, otherwise fetch from GitHub.
ENV-VAR is the environment variable to check for path override.
DEFAULT-PATH is the default local path relative to HOME.
GITHUB-REPO is the GitHub repo in \"user/repo\" format."
  (let* ((env-path (getenv env-var))
         (default-full-path (expand-file-name default-path (getenv "HOME")))
         (local-path (or env-path
                         (and (file-exists-p default-full-path) default-full-path))))
    (if local-path
        (eldev-use-local-dependency local-path)
      (eldev-use-vc-repository name :github github-repo))))

(brb-eldev-use-local-or-vc 'vulpea "VULPEA_PATH" "Developer/vulpea" "d12frosted/vulpea")
(brb-eldev-use-local-or-vc 'vui "VUI_PATH" "Developer/vui.el" "d12frosted/vui.el")

;; Tell checkdoc not to demand two spaces after a period.
(setq sentence-end-double-space nil)

(eldev-use-plugin 'autoloads)

;; We are disabling the prefix check rule, as it enforces prefixing on widgets created
;; with `define-widget'. This requirement seems wrong - even built-in widgets aren't prefixed.
;;
;; Additionally, there appears to be no way to distinguish between standard functions and widgets.
(with-eval-after-load 'package-lint
  (defun package-lint--check-defs-prefix (_prefix _definitions)
    "Verify that symbol DEFINITIONS start with package PREFIX."))
